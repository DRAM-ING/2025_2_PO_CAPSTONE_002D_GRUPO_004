<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagramas de Flujo de Trabajo OT - PGF</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }
        
        h1 {
            color: #1e40af;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #6b7280;
            margin-bottom: 40px;
            font-size: 1.1em;
        }
        
        .diagram-section {
            margin-bottom: 60px;
            padding: 30px;
            background: #f9fafb;
            border-radius: 15px;
            border: 2px solid #e5e7eb;
        }
        
        .diagram-section h2 {
            color: #374151;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #3b82f6;
            padding-bottom: 10px;
        }
        
        .diagram-section p {
            color: #6b7280;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .mermaid {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .toc {
            background: #eff6ff;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            border: 2px solid #3b82f6;
        }
        
        .toc h2 {
            color: #1e40af;
            margin-bottom: 20px;
        }
        
        .toc ul {
            list-style: none;
        }
        
        .toc li {
            margin: 10px 0;
        }
        
        .toc a {
            color: #3b82f6;
            text-decoration: none;
            font-size: 1.1em;
            display: block;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .toc a:hover {
            background: #dbeafe;
            transform: translateX(5px);
        }
        
        .info-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .info-box strong {
            color: #92400e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1> Diagramas de Flujo de Trabajo OT</h1>
        <p class="subtitle">Sistema PGF - Desde Creaci贸n hasta Cierre</p>
        
        <div class="toc">
            <h2> ndice de Diagramas</h2>
            <ul>
                <li><a href="#diagrama-completo">1. Diagrama Completo (3 Capas)</a></li>
                <li><a href="#diagrama-estados">2. Diagrama de Estados</a></li>
                <li><a href="#diagrama-secuencia">3. Diagrama de Secuencia</a></li>
                <li><a href="#diagrama-componentes">4. Diagrama de Componentes</a></li>
                <li><a href="#flujo-creacion">5. Flujo de Creaci贸n de OT</a></li>
                <li><a href="#flujo-evidencia">6. Flujo de Subida de Evidencia</a></li>
                <li><a href="#flujo-pdf">7. Flujo de Generaci贸n de PDF</a></li>
                <li><a href="#arquitectura">8. Arquitectura Completa del Sistema</a></li>
                <li><a href="#flujo-trabajo-completo">9. Flujo de Trabajo OT Completo (3 Capas)</a></li>
                <li><a href="#arquitectura-mejorada">10. Arquitectura Completa Mejorada (Con Capa de Negocio)</a></li>
            </ul>
        </div>
        
        <div class="info-box">
            <strong> Tip:</strong> Puedes hacer zoom con Ctrl + Rueda del mouse o hacer clic derecho y "Inspeccionar" para ver el c贸digo Mermaid.
        </div>
        
        <!-- Diagrama 1: Completo -->
        <div id="diagrama-completo" class="diagram-section">
            <h2>1. Diagrama Completo (3 Capas)</h2>
            <p>Vista completa del flujo de trabajo de una OT mostrando todas las capas y sus interacciones.</p>
            <div class="mermaid">
graph TB
    subgraph PRESENTACION["CAPA DE PRESENTACION"]
        USUARIO["Usuario<br/>GUARDIA/SUPERVISOR/JEFE_TALLER/MECANICO"]
        FRONTEND["Frontend Next.js<br/>/workorders/create<br/>/workorders/id"]
        CLOUDFLARE["Cloudflare Tunnel<br/>HTTPS Publico"]
    end
    
    subgraph NEGOCIO["CAPA DE NEGOCIO"]
        API["API Django<br/>OrdenTrabajoViewSet<br/>ItemOTViewSet<br/>EvidenciaViewSet"]
        WORKER["Worker Celery<br/>Tareas Asincronas"]
        BEAT["Celery Beat<br/>Tareas Programadas"]
        REDIS_BROKER["Redis<br/>Broker & Cache"]
    end
    
    subgraph DATOS["CAPA DE DATOS"]
        POSTGRES[("PostgreSQL<br/>OrdenTrabajo<br/>ItemOT<br/>Evidencia<br/>Pausa<br/>Checklist")]
        LOCALSTACK["LocalStack S3<br/>Archivos & PDFs"]
        REDIS_CACHE["Redis<br/>Cache & Results"]
    end
    
    USUARIO -->|"1. Interaccion"| FRONTEND
    FRONTEND <-->|"HTTP/WebSocket"| CLOUDFLARE
    CLOUDFLARE <-->|"Proxy"| API
    API <-->|"Lee/Escribe"| POSTGRES
    API -->|"Sube archivos"| LOCALSTACK
    API <-->|"Cache"| REDIS_CACHE
    API -->|"Envia tareas"| REDIS_BROKER
    BEAT -->|"Programa tareas"| REDIS_BROKER
    REDIS_BROKER -->|"Consume"| WORKER
    WORKER <-->|"Lee/Escribe"| POSTGRES
    WORKER -->|"Sube PDFs"| LOCALSTACK
    WORKER <-->|"Resultados"| REDIS_CACHE
    
    USUARIO -->|"1. Crea OT"| FRONTEND
    FRONTEND -->|"POST /api/proxy/work/ordenes/"| API
    API -->|"INSERT OrdenTrabajo"| POSTGRES
    POSTGRES -->|"OT creada"| API
    API -->|"Response"| FRONTEND
    FRONTEND -->|"Muestra OT"| USUARIO
    
    style PRESENTACION fill:#e1f5ff
    style NEGOCIO fill:#fff4e1
    style DATOS fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 2: Estados -->
        <div id="diagrama-estados" class="diagram-section">
            <h2>2. Diagrama de Estados</h2>
            <p>Transiciones de estado de una OT desde su creaci贸n hasta su cierre.</p>
            <div class="mermaid">
stateDiagram-v2
    [*] --> ABIERTA
    
    ABIERTA --> EN_DIAGNOSTICO
    ABIERTA --> EN_PAUSA
    ABIERTA --> EN_EJECUCION
    
    EN_DIAGNOSTICO --> EN_EJECUCION
    EN_DIAGNOSTICO --> ABIERTA
    
    EN_PAUSA --> EN_EJECUCION
    
    EN_EJECUCION --> EN_PAUSA
    EN_EJECUCION --> EN_QA
    
    EN_QA --> CERRADA
    EN_QA --> EN_EJECUCION
    EN_QA --> RETRABAJO
    
    RETRABAJO --> EN_EJECUCION
    RETRABAJO --> EN_QA
    
    CERRADA --> [*]
            </div>
        </div>
        
        <!-- Diagrama 3: Secuencia -->
        <div id="diagrama-secuencia" class="diagram-section">
            <h2>3. Diagrama de Secuencia</h2>
            <p>Interacciones temporales entre componentes durante el ciclo de vida completo de una OT.</p>
            <div class="mermaid">
sequenceDiagram
    participant U as Usuario
    participant F as Frontend
    participant API as API Django
    participant PG as PostgreSQL
    participant W as Worker Celery
    participant LS as LocalStack
    participant CB as Celery Beat
    participant R as Redis
    
    Note over U,R: 1. CREACIN DE OT
    U->>F: Crea OT (formulario)
    F->>API: POST /work/ordenes/
    API->>PG: INSERT OrdenTrabajo (ABIERTA)
    PG-->>API: OT creada
    API-->>F: Response
    F-->>U: Muestra OT
    
    Note over U,R: 2. ASIGNACIN DE MECNICO
    U->>F: Asigna mec谩nico
    F->>API: POST /aprobar-asignacion/
    API->>PG: UPDATE (EN_EJECUCION)
    PG-->>API: Actualizado
    API-->>F: Estado actualizado
    F-->>U: Muestra estado
    
    Note over U,R: 3. TRABAJO EN OT
    U->>F: Agrega items / Sube evidencias
    F->>API: POST /items/ o /evidencias/
    API->>PG: INSERT ItemOT/Evidencia
    API->>LS: PUT archivo
    LS-->>API: Archivo subido
    API-->>F: Item/Evidencia creada
    F-->>U: Actualiza UI
    
    Note over U,R: 4. COLACIN AUTOMTICA
    CB->>R: Programa tarea (12:30)
    R->>W: Consume tarea
    W->>PG: INSERT Pausa, UPDATE (EN_PAUSA)
    PG-->>W: Actualizado
    
    Note over U,R: 5. ENVO A QA
    U->>F: Env铆a a QA
    F->>API: POST /en-qa/
    API->>PG: UPDATE (EN_QA)
    PG-->>API: Actualizado
    API-->>F: Estado: EN_QA
    F-->>U: Muestra estado
    
    Note over U,R: 6. CIERRE DE OT
    U->>F: Cierra OT
    F->>API: POST /cerrar/
    API->>PG: UPDATE (CERRADA)
    API->>R: Tarea: generar_pdf_cierre
    R->>W: Consume tarea
    W->>PG: SELECT OT (datos completos)
    PG-->>W: Datos de OT
    W->>W: Genera PDF (ReportLab)
    W->>LS: PUT PDF
    LS-->>W: PDF subido
    W->>PG: INSERT Evidencia (PDF)
    W->>R: Resultado (URL PDF)
    API-->>F: OT cerrada + URL PDF
    F-->>U: Muestra PDF
            </div>
        </div>
        
        <!-- Diagrama 4: Componentes -->
        <div id="diagrama-componentes" class="diagram-section">
            <h2>4. Diagrama de Componentes por Capa</h2>
            <p>Arquitectura del sistema separada en las 3 capas principales.</p>
            <div class="mermaid">
graph LR
    subgraph PRES["PRESENTACION"]
        A[Frontend Next.js]
        B[Cloudflare Tunnel]
    end
    
    subgraph NEG["NEGOCIO"]
        C[API Django]
        D[Worker Celery]
        E[Celery Beat]
    end
    
    subgraph DAT["DATOS"]
        F[(PostgreSQL)]
        G[LocalStack]
        H[Redis]
    end
    
    A <--> B
    B <--> C
    C <--> F
    C <--> G
    C <--> H
    D <--> F
    D <--> G
    D <--> H
    E --> H
    H --> D
    
    style PRES fill:#e1f5ff
    style NEG fill:#fff4e1
    style DAT fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 5: Flujo Creaci贸n -->
        <div id="flujo-creacion" class="diagram-section">
            <h2>5. Flujo de Creaci贸n de OT</h2>
            <p>Proceso detallado de creaci贸n de una nueva Orden de Trabajo.</p>
            <div class="mermaid">
flowchart LR
    A[Usuario] -->|Datos| B[Frontend]
    B -->|POST| C[API Django]
    C -->|Valida| C
    C -->|INSERT| D[(PostgreSQL)]
    D -->|Response| C
    C -->|Response| B
    B -->|Muestra| A
    
    style A fill:#ffebee
    style B fill:#e1f5ff
    style C fill:#fff4e1
    style D fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 6: Flujo Evidencia -->
        <div id="flujo-evidencia" class="diagram-section">
            <h2>6. Flujo de Subida de Evidencia</h2>
            <p>Proceso de subida de archivos (fotos/documentos) como evidencia de trabajo.</p>
            <div class="mermaid">
flowchart LR
    A[Usuario] -->|Archivo| B[Frontend]
    B -->|FormData| C[API Django]
    C -->|Valida| C
    C -->|PUT| D[LocalStack]
    C -->|INSERT| E[(PostgreSQL)]
    D -->|URL| C
    E -->|Response| C
    C -->|URL p煤blica| B
    B -->|Muestra| A
    
    style A fill:#ffebee
    style B fill:#e1f5ff
    style C fill:#fff4e1
    style D fill:#fff3e0
    style E fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 7: Flujo PDF -->
        <div id="flujo-pdf" class="diagram-section">
            <h2>7. Flujo de Generaci贸n de PDF</h2>
            <p>Proceso as铆ncrono de generaci贸n del PDF de cierre de una OT.</p>
            <div class="mermaid">
flowchart LR
    A[Usuario] -->|Cierra OT| B[Frontend]
    B -->|POST /cerrar/| C[API Django]
    C -->|UPDATE| D[(PostgreSQL)]
    C -->|Tarea| E[Redis]
    E -->|Consume| F[Worker Celery]
    F -->|SELECT| D
    D -->|Datos| F
    F -->|Genera| F
    F -->|PUT PDF| G[LocalStack]
    F -->|INSERT| D
    F -->|Resultado| E
    C -->|URL PDF| B
    B -->|Muestra PDF| A
    
    style A fill:#ffebee
    style B fill:#e1f5ff
    style C fill:#fff4e1
    style D fill:#e8f5e9
    style E fill:#f3e5f5
    style F fill:#e0f2f1
    style G fill:#fff3e0
            </div>
        </div>
        
        <!-- Diagrama 8: Arquitectura Completa -->
        <div id="arquitectura" class="diagram-section">
            <h2>8. Arquitectura Completa del Sistema</h2>
            <p>Vista general de la arquitectura del sistema PGF con todas las capas y componentes, similar al diagrama de referencia.</p>
            <div class="mermaid">
graph TB
    subgraph PRESENTACION["CAPA DE PRESENTACION"]
        WEB[Web App Browser]
        MOBILE[Mobile Browser]
        TABLET[Tablet Guardia]
    end
    
    subgraph FRONTEND["Frontend Next.js 15"]
        SSR[Server Side Rendering App Router]
        STORE[Zustand Store Estado Global]
        SSR --> STORE
    end
    
    subgraph GATEWAY["API Gateway"]
        NGINX[Nginx Reverse Proxy Load Balancer & SSL]
    end
    
    subgraph NEGOCIO["CAPA DE NEGOCIO - Backend Django 5"]
        DRF[Django REST Framework API Endpoints]
        CELERY[Celery Workers Tareas Asincronas]
        CHANNELS[Django Channels WebSockets]
        UPLOAD[Upload/Download File Handler]
    end
    
    subgraph EXTERNOS["Servicios Externos"]
        EMAIL[Email Service]
        MONITOR[Prometheus/Grafana Monitoring]
    end
    
    subgraph DATOS["CAPA DE DATOS"]
        PG[(PostgreSQL 15 Master/Slave)]
        REDIS[Redis 7 Cache & Broker]
        S3[AWS S3 / LocalStack Media Storage]
    end
    
    WEB -->|HTTPS/WSS| SSR
    MOBILE -->|HTTPS/WSS| SSR
    TABLET -->|HTTPS/WSS| SSR
    
    SSR -->|HTTPS| NGINX
    
    NGINX -->|Proxy Pass| DRF
    NGINX -->|Upgrade WS| CHANNELS
    
    DRF -->|Query/Transaccion| PG
    DRF -->|Trigger Task| CELERY
    DRF -->|Cache/Session| REDIS
    DRF -->|Send Mail| EMAIL
    DRF -->|Upload/Download| UPLOAD
    
    CELERY -->|Store Result| PG
    CELERY -->|Broker| REDIS
    CELERY -->|Upload Files| S3
    
    CHANNELS -->|Sub/Pub| REDIS
    CHANNELS -->|Broker| REDIS
    
    UPLOAD -->|PUT/GET| S3
    
    style PRESENTACION fill:#e1f5ff
    style FRONTEND fill:#e3f2fd
    style GATEWAY fill:#f3e5f5
    style NEGOCIO fill:#fff4e1
    style EXTERNOS fill:#fce4ec
    style DATOS fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 9: Flujo de Trabajo OT Completo -->
        <div id="flujo-trabajo-completo" class="diagram-section">
            <h2>9. Flujo de Trabajo OT Completo (3 Capas)</h2>
            <p>Flujo completo de una OT desde la creaci贸n hasta el cierre, mostrando todas las capas y sus interacciones.</p>
            <div class="mermaid">
graph TB
    subgraph PRESENTACION["CAPA DE PRESENTACION"]
        GUARDIA[Guardia Crea OT]
        SUPERVISOR[Supervisor Asigna Mecanico]
        MECANICO[Mecanico Trabaja en OT]
        JEFE[Jefe Taller Cierra OT]
    end
    
    subgraph FRONTEND["Frontend Next.js"]
        FORM_CREATE[Formulario Crear OT]
        FORM_ASIGNAR[Formulario Asignar]
        FORM_TRABAJO[Formulario Trabajo]
        FORM_CIERRE[Formulario Cerrar]
    end
    
    subgraph GATEWAY["API Gateway"]
        PROXY[Proxy Routes /api/proxy/work/]
    end
    
    subgraph NEGOCIO["CAPA DE NEGOCIO"]
        API_CREATE[API POST /work/ordenes/ Crea OT]
        API_ASIGNAR[API POST /aprobar-asignacion/]
        API_ITEMS[API POST /items/ Agrega Items]
        API_EVIDENCIAS[API POST /evidencias/ Sube Archivos]
        API_QA[API POST /en-qa/ Envia a QA]
        API_CERRAR[API POST /cerrar/ Cierra OT]
        CELERY_COLACION[Celery Beat Colacion 12:30-13:15]
        CELERY_PDF[Celery Worker Genera PDF]
    end
    
    subgraph DATOS["CAPA DE DATOS"]
        PG_OT[(PostgreSQL OrdenTrabajo)]
        PG_ITEMS[(PostgreSQL ItemOT)]
        PG_EVID[(PostgreSQL Evidencia)]
        PG_PAUSA[(PostgreSQL Pausa)]
        REDIS_TASK[Redis Broker Tareas]
        REDIS_CACHE[Redis Cache]
        S3_FILES[S3/LocalStack Archivos & PDFs]
    end
    
    GUARDIA -->|1. Crea OT| FORM_CREATE
    FORM_CREATE -->|POST| PROXY
    PROXY -->|POST /work/ordenes/| API_CREATE
    API_CREATE -->|INSERT| PG_OT
    
    SUPERVISOR -->|2. Asigna| FORM_ASIGNAR
    FORM_ASIGNAR -->|POST| PROXY
    PROXY -->|POST /aprobar-asignacion/| API_ASIGNAR
    API_ASIGNAR -->|UPDATE EN_EJECUCION| PG_OT
    
    MECANICO -->|3. Agrega Items| FORM_TRABAJO
    FORM_TRABAJO -->|POST /items/| PROXY
    PROXY -->|POST| API_ITEMS
    API_ITEMS -->|INSERT| PG_ITEMS
    
    MECANICO -->|4. Sube Evidencias| FORM_TRABAJO
    FORM_TRABAJO -->|POST /evidencias/| PROXY
    PROXY -->|POST| API_EVIDENCIAS
    API_EVIDENCIAS -->|PUT archivo| S3_FILES
    API_EVIDENCIAS -->|INSERT| PG_EVID
    
    CELERY_COLACION -->|12:30 Programa| REDIS_TASK
    REDIS_TASK -->|Consume| CELERY_COLACION
    CELERY_COLACION -->|INSERT Pausa UPDATE EN_PAUSA| PG_PAUSA
    CELERY_COLACION -->|UPDATE| PG_OT
    
    MECANICO -->|5. Envia a QA| FORM_TRABAJO
    FORM_TRABAJO -->|POST /en-qa/| PROXY
    PROXY -->|POST| API_QA
    API_QA -->|UPDATE EN_QA| PG_OT
    
    JEFE -->|6. Cierra OT| FORM_CIERRE
    FORM_CIERRE -->|POST /cerrar/| PROXY
    PROXY -->|POST| API_CERRAR
    API_CERRAR -->|UPDATE CERRADA| PG_OT
    API_CERRAR -->|Tarea PDF| REDIS_TASK
    REDIS_TASK -->|Consume| CELERY_PDF
    CELERY_PDF -->|SELECT datos| PG_OT
    CELERY_PDF -->|PUT PDF| S3_FILES
    CELERY_PDF -->|INSERT Evidencia| PG_EVID
    
    style PRESENTACION fill:#e1f5ff
    style FRONTEND fill:#e3f2fd
    style GATEWAY fill:#f3e5f5
    style NEGOCIO fill:#fff4e1
    style DATOS fill:#e8f5e9
            </div>
        </div>
        
        <!-- Diagrama 10: Arquitectura Mejorada -->
        <div id="arquitectura-mejorada" class="diagram-section">
            <h2>10. Arquitectura Completa Mejorada (Con Capa de Negocio)</h2>
            <p>Arquitectura completa del sistema incluyendo la Capa de Negocio con servicios espec铆ficos del dominio de OTs.</p>
            <div class="mermaid">
flowchart TB
    subgraph Clientes["CAPA DE PRESENTACION - Clientes"]
        Web[Web App]
        Mobile[Mobile Browser]
        Tablet[Tablet Guardia]
    end
    
    subgraph FrontendZone["Frontend Next.js 15"]
        NextJS[Server Side Rendering App Router]
        Zustand[Zustand Store]
    end
    
    subgraph DMZ["API Gateway"]
        Nginx[Nginx Reverse Proxy Load Balancer & SSL]
    end
    
    subgraph AppLayer["Backend Django 5"]
        API[Django REST Framework]
        Channels[Django Channels WebSockets]
        Celery[Celery Workers Tareas Asincronas]
    end
    
    subgraph BusinessLayer["CAPA DE NEGOCIO"]
        OTService[Servicio Ordenes Trabajo Transiciones de Estado]
        ItemService[Servicio Items OT Gestion de Repuestos]
        EvidenceService[Servicio Evidencias Gestion de Archivos]
        ColacionService[Servicio Colacion Pausas Automaticas]
        PDFService[Servicio PDF Generacion de Documentos]
    end
    
    subgraph DataLayer["CAPA DE DATOS"]
        Postgres[("PostgreSQL 15 Master/Slave")]
        Redis[("Redis 7 Cache & Broker")]
        S3[("AWS S3 / LocalStack Media Storage")]
    end
    
    subgraph External["Servicios Externos"]
        SMTP[Email Service]
        Monitor[Prometheus/Grafana]
    end
    
    Web -->|HTTPS/WSS| NextJS
    Mobile -->|HTTPS/WSS| NextJS
    Tablet -->|HTTPS/WSS| NextJS
    NextJS -->|HTTPS| Nginx
    Nginx -->|Proxy Pass| API
    Nginx -->|Upgrade WS| Channels
    
    API -->|Llama| OTService
    API -->|Llama| ItemService
    API -->|Llama| EvidenceService
    API -->|Trigger Task| Celery
    API -->|Cache/Session| Redis
    
    Channels -->|Sub/Pub| Redis
    
    Celery -->|Ejecuta| ColacionService
    Celery -->|Ejecuta| PDFService
    Celery -->|Broker| Redis
    Celery -->|Send Mail| SMTP
    
    OTService -->|Query/Transaccion| Postgres
    ItemService -->|Query/Transaccion| Postgres
    EvidenceService -->|Query/Transaccion| Postgres
    EvidenceService -->|Upload/Download| S3
    ColacionService -->|Query/Transaccion| Postgres
    PDFService -->|Query/Transaccion| Postgres
    PDFService -->|Upload/Download| S3
    PDFService -->|Store Result| Postgres
    
    Web:::client
    Mobile:::client
    Tablet:::client
    NextJS:::frontend
    Zustand:::frontend
    Nginx:::gateway
    API:::backend
    Channels:::backend
    Celery:::backend
    OTService:::business
    ItemService:::business
    EvidenceService:::business
    ColacionService:::business
    PDFService:::business
    Postgres:::data
    Redis:::data
    S3:::data
    SMTP:::ext
    Monitor:::ext
    
    classDef client fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef frontend fill:#e0f7fa,stroke:#006064,stroke-width:2px
    classDef gateway fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef backend fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    classDef business fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    classDef data fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef ext fill:#eceff1,stroke:#455a64,stroke-width:2px,stroke-dasharray: 5 5
            </div>
        </div>
        
        <div class="info-box" style="margin-top: 40px;">
            <strong> Nota:</strong> Este archivo HTML puede abrirse directamente en cualquier navegador. Los diagramas se renderizan autom谩ticamente usando Mermaid.js.
        </div>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#3b82f6',
                primaryTextColor: '#1e40af',
                primaryBorderColor: '#1e40af',
                lineColor: '#6b7280',
                secondaryColor: '#e0f2f1',
                tertiaryColor: '#f3e5f5'
            }
        });
    </script>
</body>
</html>

